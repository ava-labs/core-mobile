# Key Storage Refactoring

## Description and scope

This change refactors key storage to support multi-wallet functionality.

1. Redux Store Changes

   - Prepares store to handle multiple wallets
     - The `WalletsState` has been updated to hold a collection of wallets and track the currently active one
   - Adds new wallet state slice to manage wallet metadata
     - Adds new reducers and actions for adding, removing, setting name and active wallet
     - Adds new selectors:`selectWallets`, `selectActiveWalletId`, `selectActiveWallet`, `selectWalletById`
   - Migrates existing single wallet data to new multi-wallet structure
     - Existing Keychain service is moved to per-wallet service, where wallet-id is randomly generated

2. BiometrySDK Changes

   - Updates storage mechanism to support per-wallet secrets
   - Maintains backwards compatibility for existing users by leaving
   - Adds function for new wallets to use updated storage pattern:
     - Wallet secret encrypted with PIN
     - PIN optionally encrypted with biometrics
     - PIN cached in memory during active session

3. Wallet Creation Flow

   - Modified onPinCreated flow to use new storage pattern
   - Stores wallet secret encrypted with PIN
   - If biometrics enabled, encrypts PIN with biometrics
   - Caches PIN in memory for session duration

The changes maintain backwards compatibility while setting up infrastructure for multi-wallet support.
This change does NOT use new storage pattern (cached PIN).

## Testing

- have any wallet unlocked on previous code version
- update to this code version
- check if you can normally use wallet as before
